effectively an optimized version of shartika
